# Remediation Plan: PR #103 - perf(e2e): Optimize Playwright test suite

**URL**: https://github.com/komod0/diabetify-dev/pull/103

## 1. Summary

This PR optimizes the Playwright E2E test suite, reducing the number of test runs by 71% and significantly speeding up local and CI execution times. The changes are confined to `playwright.config.ts` and related documentation.

## 2. Blockers

The PR is currently blocked by failing CI/CD checks, specifically within the E2E test suite.

| Blocker                          | Details                                                                                                 | Severity | Status      |
| -------------------------------- | ------------------------------------------------------------------------------------------------------- | -------- | ----------- |
| **Failing E2E Functional Tests** | 2 form validation tests in `error-handling.spec.ts` are failing, indicating a potential regression or bug. | **High** | ðŸ”´ **Needs Fix** |
| **Failing Visual Regression**    | ~50% of visual tests are failing due to screenshot mismatches. This is expected with rendering differences. | **Medium** | ðŸ”´ **Needs Fix** |
| **Code Review & Approval**       | The PR has not yet been reviewed or approved by the maintainers.                                        | **Low**  | ðŸŸ¡ **Pending**  |

## 3. Remediation Steps

The following steps must be taken to unblock and merge this pull request.

### Step 1: Fix Failing E2E Functional Tests

The two failing form validation tests must be investigated and fixed. This is the highest priority.

**File to Edit**: `playwright/tests/error-handling.spec.ts`

**Actions**:
1.  **Checkout the branch**:
    ```bash
    git checkout feature/playwright-e2e-optimization
    ```
2.  **Run the failing tests locally**: Isolate the two failing tests to replicate the CI failure.
    ```bash
    pnpm exec playwright test playwright/tests/error-handling.spec.ts
    ```
3.  **Debug and Fix**: Identify the root cause of the validation failures. It could be a legitimate bug in the application code or an issue with the test locators/assertions.
4.  **Commit the fix**:
    ```bash
    git add playwright/tests/error-handling.spec.ts
    # Add application code changes if any
    git commit -m "fix(e2e): correct form validation errors in error-handling spec"
    ```

### Step 2: Update Visual Regression Baselines

The visual differences are expected and not considered a bug. The baseline images need to be updated to reflect the current state of the UI.

**Actions**:
1.  **Generate new baseline screenshots**: Run the visual regression tests in "update" mode. The command for this is likely `pnpm test:visual:mock:update` or similar.
    ```bash
    pnpm run test:visual:mock:update
    ```
2.  **Review the changes**: Carefully inspect the changed screenshot files in `playwright/tests/*-snapshots/` to ensure the UI changes are intentional and correct.
3.  **Commit the new baselines**:
    ```bash
    git add playwright/tests/
    git commit -m "chore(e2e): update visual regression baselines"
    ```

### Step 3: Push Changes and Verify CI

With the fixes and updates applied, the changes need to be pushed to the remote branch to trigger a new CI run.

**Actions**:
1.  **Push the commits**:
    ```bash
    git push origin feature/playwright-e2e-optimization
    ```
2.  **Monitor CI Pipeline**: Go to the PR page on GitHub and monitor the CI checks. Ensure all steps, especially the E2E tests, pass successfully.

### Step 4: Request Code Review and Merge

Once the CI pipeline is green, the PR is ready for final review and merging.

**Actions**:
1.  **Request Review**: Formally request a review from the project maintainers through the GitHub UI.
2.  **Address Feedback**: If any feedback is provided, make the necessary changes and push them.
3.  **Merge the PR**: After approval, use a **squash merge** to combine the commits into a single, clean commit on the `master` branch.

## 4. Recommended Merge Sequence

This PR can be merged **independently** of other issues, as it only affects the test suite configuration. However, it is recommended to address this **after fixing critical bugs** if any are found, as a stable test suite is necessary to validate other changes. Given the current issue list, this PR should be addressed with **high priority** to improve CI/CD pipeline efficiency.
