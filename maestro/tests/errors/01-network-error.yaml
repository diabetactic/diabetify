# ==========================================
# Test: Network Error Handling
# Description: Verify app handles network errors gracefully
# Note: Full offline testing requires airplane mode or network interception
#       This test verifies basic error handling UI
# Uses .* wildcards for bilingual support with special chars
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN (while online)
- runFlow: ../../flows/login.yaml

# 2. NAVIGATE TO READINGS
- runFlow: ../../flows/navigate-readings.yaml

# 3. VERIFY READINGS PAGE LOADED
- extendedWaitUntil:
    visible:
      text: '.*Mostrando.*lecturas.*|.*Showing.*readings.*|.*Lecturas.*|.*Readings.*'
    timeout: 8000

# 4. DISABLE NETWORK
- setNetworkConnection: "none"
- waitForAnimationToEnd:
    timeout: 1000

# 5. PULL TO REFRESH TO TRIGGER NETWORK ERROR
- swipe:
    direction: DOWN
    duration: 500
- waitForAnimationToEnd:
    timeout: 2000

# 6. VERIFY OFFLINE/ERROR MESSAGE APPEARS
- extendedWaitUntil:
    visible:
      text: '.*Error.*|.*Sin.*conexi.*n.*|.*Offline.*'
    timeout: 10000

# 7. RE-ENABLE NETWORK TO CLEAN UP
- setNetworkConnection: "all"
- waitForAnimationToEnd:
    timeout: 1000

# 8. PULL TO REFRESH AGAIN TO VERIFY RECOVERY
- swipe:
    direction: DOWN
    duration: 500
- waitForAnimationToEnd:
    timeout: 2000

# 9. VERIFY DATA IS SHOWN AGAIN
- extendedWaitUntil:
    visible:
      text: '.*Mostrando.*lecturas.*|.*Showing.*readings.*'
    timeout: 10000
