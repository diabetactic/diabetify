# ==========================================
# Test: Appointments Page - Appointment Card Interaction
# Description: Verify appointment cards can be tapped and show details
# NOTE: This test validates appointment card interaction.
#       Full accept/deny flow requires clean backend state.
#       For full flow testing, use Playwright against local Docker.
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN
- runFlow: ../../flows/login.yaml

# 2. NAVIGATE TO APPOINTMENTS
- runFlow: ../../flows/navigate-appointments.yaml

# 3. VERIFY PAGE HEADER LOADED
- extendedWaitUntil:
    visible:
      text: 'Citas|Appointments'
    timeout: 8000
- waitForAnimationToEnd:
    timeout: 2000

# 4. WAIT FOR LOADING TO COMPLETE
- extendedWaitUntil:
    notVisible:
      text: 'Cargando citas|Loading appointments|Cargando...'
    timeout: 20000
- waitForAnimationToEnd:
    timeout: 2000

# 5. VERIFY QUEUE CONTENT IS VISIBLE (either status or request button)
- extendedWaitUntil:
    visible:
      text: 'Estado de la Cola|Queue Status|Solicitar Cita|Request Appointment|No tienes citas|No appointments'
    timeout: 10000

# 6. VERIFY APPOINTMENT CONTENT IS VISIBLE
- extendedWaitUntil:
    visible:
      text: 'ACTUAL|Citas Anteriores|Past Appointments|Solicitar Cita|Request Appointment|Pendiente|Pending|No tienes citas|No appointments'
    timeout: 5000

# 7. IF THERE ARE APPOINTMENTS, TRY TO EXPAND PAST APPOINTMENTS
- tapOn:
    text: 'Citas Anteriores|Past Appointments'
    optional: true
- waitForAnimationToEnd:
    timeout: 1500

# 8. VERIFY PAGE STRUCTURE (appointments page is displayed)
- assertVisible:
    text: 'Citas|Appointments'
# Test passes - page loaded and shows appointment content
