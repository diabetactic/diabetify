# ==========================================
# Test: Simple Appointment Request (no logout)
# Description: Request appointment assuming user is already logged in
# ==========================================

appId: io.diabetactic.app

env:
  TEST_USER_ID: '1000'
  TEST_USER_PASSWORD: 'tuvieja'

---
# 1. Verify we're logged in (dashboard visible)
- extendedWaitUntil:
    visible:
      text: '.*Inicio.*|.*Home.*|.*Dashboard.*|.*Lecturas.*|.*Readings.*'
    timeout: 10000

# 2. Navigate to Appointments tab
- tapOn:
    text: '.*Citas.*|.*Appointments.*'
- waitForAnimationToEnd:
    timeout: 2000

# 3. Wait for appointments screen to load
- extendedWaitUntil:
    visible:
      text: '.*Citas.*|.*Appointments.*|.*Pr.*xima.*|.*Next.*|.*Solicitar.*|.*Request.*'
    timeout: 10000

# 4. Verify current state (should be NONE or show existing appointments)
- waitForAnimationToEnd:
    timeout: 2000

# 5. Request new appointment if button is available
- tapOn:
    text: '.*Solicitar.*Cita.*|.*Request.*Appointment.*'
    optional: true
- waitForAnimationToEnd:
    timeout: 1000

# 6. If modal/form appears, fill it out
- tapOn:
    text: '.*Confirmar.*|.*Confirm.*|.*Enviar.*|.*Submit.*'
    optional: true
- waitForAnimationToEnd:
    timeout: 3000

# 7. Verify appointment was requested (look for PENDING state indicator)
- extendedWaitUntil:
    visible:
      text: '.*Pendiente.*|.*Pending.*|.*Solicitada.*|.*Requested.*'
    timeout: 15000
    optional: true
