# ==========================================
# Test: Appointments Page - Complete UI Verification
# Description: Comprehensive verification of appointments page elements
# NOTE: Full state machine flow (NONE->PENDING->ACCEPTED->CREATED)
#       requires clean backend state not available in shared environments.
#       This test verifies all UI elements work regardless of state.
#       For full flow testing, use Playwright against local Docker.
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN WITH FRESH STATE
- runFlow: ../../flows/login.yaml

# 2. VERIFY WE START ON A TAB PAGE
- extendedWaitUntil:
    visible:
      text: 'Inicio|Home|Lecturas|Readings|Citas|Appointments|Perfil|Profile'
    timeout: 8000

# 3. NAVIGATE TO APPOINTMENTS TAB
- runFlow: ../../flows/navigate-appointments.yaml

# 4. VERIFY APPOINTMENTS PAGE HEADER
- extendedWaitUntil:
    visible:
      text: 'Citas|Appointments'
    timeout: 5000

# 5. VERIFY QUEUE STATUS SECTION
- extendedWaitUntil:
    visible:
      text: 'Estado de la Cola|Queue Status'
    timeout: 5000

# 6. VERIFY CONTENT AREA HAS EXPECTED STRUCTURE
# Should show either request button, current appointment, or both
- extendedWaitUntil:
    visible:
      text: 'ACTUAL|Solicitar Cita|Request Appointment|Citas Anteriores'
    timeout: 5000

# 7. TEST PULL-TO-REFRESH
- swipe:
    direction: DOWN
    duration: 500
- waitForAnimationToEnd:
    timeout: 3000

# 8. VERIFY PAGE STILL LOADS AFTER REFRESH
- assertVisible:
    text: 'Estado de la Cola|Queue Status'

# 9. NAVIGATE TO PROFILE AND BACK
- tapOn:
    text: 'Perfil|Profile'
- waitForAnimationToEnd:
    timeout: 1500
- assertVisible:
    text: 'Perfil|Profile'

# 10. RETURN TO APPOINTMENTS
- tapOn:
    text: 'Citas|Appointments'
- waitForAnimationToEnd:
    timeout: 1500

# 11. FINAL VERIFICATION
- assertVisible:
    text: 'Estado de la Cola|Queue Status'
# Test passes - appointments page UI works correctly across navigation
