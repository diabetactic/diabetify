appId: io.diabetactic.app
tags:
  - integration
  - smoke
---
# Integration Test: Add reading and verify dashboard updates
# Uses COORDINATE-BASED selectors

# Login
- runFlow:
    file: ../../flows/auth/login.yaml

# Step 1: Capture initial dashboard state
- tapOn:
    point: "10%,97%"
- waitForAnimationToEnd:
    timeout: 3000

- takeScreenshot: maestro/screenshots/reading-dash-01-before.png

# Step 2: Add first reading (90)
- tapOn:
    point: "30%,97%"
- waitForAnimationToEnd:
    timeout: 3000

- tapOn:
    point: "50%,90%"
- waitForAnimationToEnd:
    timeout: 3000

- tapOn:
    point: "50%,35%"
- eraseText
- inputText: "90"
- hideKeyboard

- tapOn:
    point: "50%,85%"
- waitForAnimationToEnd:
    timeout: 3000

# Add second reading (120)
- tapOn:
    point: "50%,90%"
- waitForAnimationToEnd:
    timeout: 3000

- tapOn:
    point: "50%,35%"
- eraseText
- inputText: "120"
- hideKeyboard

- tapOn:
    point: "50%,85%"
- waitForAnimationToEnd:
    timeout: 3000

# Add third reading (150)
- tapOn:
    point: "50%,90%"
- waitForAnimationToEnd:
    timeout: 3000

- tapOn:
    point: "50%,35%"
- eraseText
- inputText: "150"
- hideKeyboard

- tapOn:
    point: "50%,85%"
- waitForAnimationToEnd:
    timeout: 3000

# Step 3: Return to dashboard and verify stats changed
- tapOn:
    point: "10%,97%"
- waitForAnimationToEnd:
    timeout: 3000

# Wait for stats to recalculate
- waitForAnimationToEnd:
    timeout: 3000

- takeScreenshot: maestro/screenshots/reading-dash-02-after.png

# Step 4: Scroll to see recent readings
- scroll
- waitForAnimationToEnd:
    timeout: 2000

- takeScreenshot: maestro/screenshots/reading-dash-03-verified.png

# Step 5: Verify readings in dedicated readings tab
- tapOn:
    point: "30%,97%"
- waitForAnimationToEnd:
    timeout: 3000

- takeScreenshot: maestro/screenshots/reading-dash-04-readings-tab.png

# CLEANUP
- stopApp
