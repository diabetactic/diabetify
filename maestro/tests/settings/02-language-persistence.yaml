# ==========================================
# Test: Language Selector Functionality
# Description: Verify language selector can be opened and options displayed.
# Note: Full language change and app restart persistence testing unreliable in Maestro.
#       This test verifies the selector UI works correctly.
# Location: Profile page -> Preferences section
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN
- runFlow: ../../flows/login.yaml

# 2. NAVIGATE TO PROFILE TAB
- runFlow: ../../flows/navigate-profile.yaml

# 3. SCROLL DOWN TO PREFERENCES SECTION
- swipe:
    direction: UP
    duration: 400
- waitForAnimationToEnd:
    timeout: 1000

# 4. VERIFY PREFERENCES SECTION IS VISIBLE
- extendedWaitUntil:
    visible:
      text: 'Preferencias|Preferences'
    timeout: 5000

# 5. VERIFY LANGUAGE LABEL IS VISIBLE
- assertVisible:
    text: 'Idioma|Language'

# 6. TAP LANGUAGE SELECTOR TO OPEN IT
- tapOn:
    id: 'language-selector'
- waitForAnimationToEnd:
    timeout: 2000

# 7. VERIFY ALERT OPENED WITH LANGUAGE OPTIONS
- extendedWaitUntil:
    visible:
      text: 'English'
    timeout: 5000

# 8. VERIFY SPANISH OPTION IS ALSO VISIBLE
- assertVisible:
    text: 'Espa√±ol'

# 9. CANCEL/DISMISS THE ALERT (tap outside or cancel button)
- tapOn:
    text: 'Cancelar|Cancel'
- waitForAnimationToEnd:
    timeout: 1000

# 10. VERIFY WE'RE BACK ON PROFILE (alert dismissed)
- extendedWaitUntil:
    visible:
      text: 'Preferencias|Preferences'
    timeout: 5000

# 11. VERIFY LANGUAGE LABEL STILL VISIBLE (back on profile)
- assertVisible:
    text: 'Idioma|Language'
