# ==========================================
# Test: Settings Theme Persistence
# Description: Verify theme setting persists across app restarts
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN
- runFlow: ../../flows/login.yaml

# 2. NAVIGATE TO SETTINGS (via Profile or Menu)
- tapOn:
    text: 'Perfil|Profile'
- waitForAnimationToEnd

# 3. OPEN SETTINGS
- tapOn:
    text: 'Configuración|Settings|Ajustes'
- waitForAnimationToEnd

# 4. VERIFY SETTINGS PAGE
- extendedWaitUntil:
    visible:
      text: 'Configuración|Settings'
    timeout: 5000

# 5. FIND THEME TOGGLE
- extendedWaitUntil:
    visible:
      text: 'Tema|Theme|Modo Oscuro|Dark Mode'
    timeout: 3000

# 6. TOGGLE THEME (Dark Mode)
- tapOn:
    text: 'Tema|Theme|Modo Oscuro|Dark Mode'
- waitForAnimationToEnd

# 7. VERIFY THEME CHANGED (visual check)
- assertVisible:
    text: 'Oscuro|Dark'
    optional: true

# 8. RESTART APP TO TEST PERSISTENCE
- stopApp
- waitForAnimationToEnd:
    timeout: 1000
- launchApp
- waitForAnimationToEnd

# 9. LOGIN AGAIN
- runFlow: ../../flows/login.yaml

# 10. NAVIGATE BACK TO SETTINGS
- tapOn:
    text: 'Perfil|Profile'
- waitForAnimationToEnd
- tapOn:
    text: 'Configuración|Settings|Ajustes'
- waitForAnimationToEnd

# 11. VERIFY THEME SETTING PERSISTED
- extendedWaitUntil:
    visible:
      text: 'Oscuro|Dark'
    timeout: 5000

# 12. TOGGLE BACK TO LIGHT MODE (cleanup)
- tapOn:
    text: 'Tema|Theme|Modo Oscuro|Dark Mode'
- waitForAnimationToEnd
