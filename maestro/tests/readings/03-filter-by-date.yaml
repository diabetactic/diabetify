# ==========================================
# Test: Readings - Filter UI Visibility
# Description: Verify filter modal can be opened and closed
# SIMPLIFIED: Complex date picker interactions delegated to Playwright
# ==========================================

appId: io.diabetactic.app

---
# 1. LOGIN WITH FRESH STATE
- runFlow: ../../flows/login.yaml

# 2. NAVIGATE TO READINGS TAB
- runFlow: ../../flows/navigate-readings.yaml

# 3. WAIT FOR READINGS PAGE TO FULLY HYDRATE
- extendedWaitUntil:
    visible:
      text: 'Mostrando.*lecturas|Showing.*readings|Lecturas|Readings'
    timeout: 10000
- waitForAnimationToEnd:
    timeout: 2000

# 4. TAP FILTER BUTTON (filter icon in toolbar)
# Using point tap since no id/data-testid exists for filter button
- tapOn:
    point: '90%,10%'
- waitForAnimationToEnd:
    timeout: 2000

# 5. VERIFY FILTER MODAL OPENED
- extendedWaitUntil:
    visible:
      text: 'Filtrar Lecturas|Filter Readings|Filtros|Filters'
    timeout: 8000

# 6. VERIFY DATE RANGE OPTION IS VISIBLE
- assertVisible:
    text: 'Rango de Fecha|Date Range|Desde|From|Hasta|To'

# 7. VERIFY STATUS FILTER IS VISIBLE
- assertVisible:
    text: 'Estado|Status'

# 8. CLOSE FILTER MODAL WITHOUT APPLYING
# Tap outside modal or use back button
- tapOn:
    point: '50%,95%'
- waitForAnimationToEnd:
    timeout: 2000

# 9. VERIFY MODAL CLOSED AND BACK ON READINGS PAGE
- extendedWaitUntil:
    visible:
      text: 'Mostrando.*lecturas|Showing.*readings'
    timeout: 8000

# 10. VERIFY NO FILTERS APPLIED (no filter chips)
- assertVisible:
    text: 'Lecturas|Readings'
