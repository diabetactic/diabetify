appId: io.diabetactic.app
---
# Reusable Flow: Verify Offline Mode
# Tests offline-first functionality
#
# Usage:
#   - runFlow: maestro/flows/verify-offline-mode.yaml

# Enable airplane mode
- evalScript: ${device.startAirplaneMode()}

# Verify offline indicator appears
- runFlow:
    when:
      visible: "Offline"
    commands:
      - assertVisible: "Offline"
      - takeScreenshot: maestro/screenshots/offline-indicator.png

# Test navigation still works offline
- tapOn: "Dashboard"
- assertVisible: "Dashboard"

- tapOn: "Readings"
- assertVisible: "Readings"

# Verify cached data is accessible
- assertVisible:
    text: "(No data|cached data|Last sync)"

- takeScreenshot: maestro/screenshots/offline-cached-data.png

# Disable airplane mode
- evalScript: ${device.stopAirplaneMode()}

# Wait for reconnection
- waitForAnimationToEnd:
    timeout: 5000
