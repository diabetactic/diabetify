appId: io.diabetactic.app
---
# Deletes all visible readings
# WARNING: This will delete ALL readings, use with caution
# Best used with test accounts only

# Navigate to readings
- tapOn:
    id: "tab-button-readings"
- waitForAnimationToEnd

# Check if there are any readings
- runFlow:
    when:
      notVisible: "mg/dL|mmol/L"
    commands:
      - stopApp  # No readings to delete

# Delete readings one by one
# Note: Maestro doesn't support true loops, so we repeat a reasonable number
- repeat:
    times: 10  # Delete up to 10 readings
    commands:
      # Check if readings still exist
      - runFlow:
          when:
            visible: "mg/dL|mmol/L"
          commands:
            # Try swipe to reveal delete
            - swipe:
                from:
                  text: ".*mg/dL.*|.*mmol/L.*"
                  index: 0
                direction: LEFT
            - tapOn:
                text: "Eliminar|Delete"
                optional: true
            - waitForAnimationToEnd

            # Confirm deletion if asked
            - tapOn:
                text: "Confirmar|Confirm|Sí|Yes"
                optional: true
            - waitForAnimationToEnd:
                timeout: 5000

            # Alternative: Try long press
            - longPressOn:
                text: ".*mg/dL.*|.*mmol/L.*"
                index: 0
                optional: true
            - tapOn:
                text: "Eliminar|Delete"
                optional: true
            - tapOn:
                text: "Confirmar|Confirm|Sí|Yes"
                optional: true
            - waitForAnimationToEnd

# Final check - should show empty state
- assertVisible:
    text: "No hay lecturas|No readings|Sin datos|No data"
    optional: true

# Return to dashboard
- tapOn: "Inicio|Home|Dashboard"
- waitForAnimationToEnd