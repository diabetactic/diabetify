version = 1

test_coverage_enabled = true

test_patterns = [
  "src/**/*.spec.ts",
  "src/**/*.test.ts",
  "src/app/tests/**",
  "playwright/**",
  "maestro/**"
]

exclude_patterns = [
  # Build outputs
  "www/**",
  "dist/**",
  ".angular/**",

  # Dependencies
  "node_modules/**",

  # Android/iOS build artifacts
  "android/.gradle/**",
  "android/build/**",
  "android/app/build/**",
  "android/capacitor-cordova-android-plugins/build/**",
  "ios/Pods/**",
  "ios/build/**",

  # Test files (console.log, any, mocks are acceptable)
  "**/*.spec.ts",
  "**/*.test.ts",
  "**/tests/**",
  "src/app/tests/**",
  "playwright/**",
  "maestro/**",
  "src/test-setup/**",
  "src/test-setup.ts",

  # Dev/debug code (not production)
  "src/app/shared/components/debug-panel/**",
  "src/app/testing/**",

  # Test/report artifacts
  "coverage/**",
  "playwright/artifacts/**",
  "playwright-report/**",
  "maestro/.maestro/**",
  "html/**",

  # Generated/config files
  "src/polyfills.ts",
  "src/environments/environment.prod.ts",
  "*.config.js",
  "*.config.ts",
  "playwright.config.ts",
  "vitest.config.ts",
  "tailwind.config.js",

  # Vendor/third-party
  "**/vendor/**",

  # Mock infrastructure
  "src/mocks/**",
  "src/setup-polyfills.ts",

  # Angular NgModules (class-as-namespace pattern)
  "**/*.module.ts",

  # Type-only files (no testable logic)
  "**/index.ts",
  "**/*.model.ts",
  "**/constants/**",
  "src/app/shared/icons/**",

  # Mock services
  "src/app/core/services/mock-adapter.service.ts",
  "src/app/shared/components/env-badge/**",

  # IDE/editor
  ".idea/**",
  ".vscode/**",

  # Scripts
  "scripts/**"
]

[[analyzers]]
name = "javascript"
enabled = true

  [analyzers.meta]
  plugins = ["angular"]
  environment = ["vitest", "browser"]
  dialect = "typescript"

  # Skip rules that don't align with our codebase patterns
  # Configure additional rules in DeepSource dashboard: Settings > Quality Gates
  [analyzers.meta.skip_doc_coverage]
  # Logger service legitimately uses console methods
  skip_functions = [
    "writeLog",
    "warn",
    "error", 
    "debug",
    "info"
  ]
