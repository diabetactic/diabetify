version = 1

# DeepSource Configuration for Diabetify
# Angular 21 + Ionic 8 + TypeScript 5.9 + Vitest

# Test coverage reporting (uploads from CI)
test_coverage_enabled = true

# Files to exclude from analysis
exclude_patterns = [
  # Build outputs
  "www/**",
  "dist/**",
  ".angular/**",

  # Dependencies
  "node_modules/**",

  # Android build artifacts
  "android/.gradle/**",
  "android/build/**",
  "android/app/build/**",
  "android/capacitor-cordova-android-plugins/build/**",

  # iOS artifacts (if added later)
  "ios/Pods/**",
  "ios/build/**",

  # Test files (console.log, any, mocks are acceptable in tests)
  "**/*.spec.ts",
  "**/*.test.ts",
  "**/tests/**",
  "src/app/tests/**",
  "playwright/**",
  "maestro/**",
  "src/test-setup/**",

  # Dev-only debug components (not production code, don't need coverage)
  "src/app/shared/components/debug-panel/**",
  "src/app/testing/**",

  # Test artifacts
  "coverage/**",
  "playwright/artifacts/**",
  "playwright-report/**",
  "maestro/.maestro/**",

  # Generated files
  "src/polyfills.ts",
  "src/environments/environment.prod.ts",

  # Third-party and vendor files
  "**/vendor/**",

  # Mock infrastructure (intentional patterns - not production code)
  "src/mocks/**",
  "src/setup-polyfills.ts",

  # Angular NgModules (class-as-namespace is legitimate Angular pattern)
  "**/*.module.ts",

  # Mock services (intentional mock patterns)
  "src/app/core/services/mock-adapter.service.ts",
  "src/app/shared/components/env-badge/**",

  # IDE and editor
  ".idea/**",
  ".vscode/**",

  # Scripts and config (not production code)
  "scripts/**",
  "*.config.js",
  "*.config.ts"
]

# JavaScript/TypeScript Analyzer (primary)
[[analyzers]]
name = "javascript"
enabled = true

  [analyzers.meta]
  # Angular 21 framework support
  plugins = [
    "angular"
  ]

  # Vitest test environment
  environment = [
    "vitest",
    "browser"
  ]

  # TypeScript version
  dialect = "typescript"

# Test Coverage Analyzer
[[analyzers]]
name = "test-coverage"
enabled = true

  [analyzers.meta]
  # Patterns to exclude from coverage calculation
  # These files are not production code or have no testable logic
  exclude_patterns = [
    # Test infrastructure (not production code)
    "src/app/tests/**",
    "src/app/testing/**",
    "src/test-setup/**",
    "src/mocks/**",

    # Dev-only components
    "src/app/shared/components/debug-panel/**",
    "src/app/shared/components/env-badge/**",
    "src/app/shared/icons/**",

    # Angular boilerplate with no logic
    "**/*.module.ts",
    "**/index.ts",
    "**/*.model.ts",
    "**/constants/**",

    # Config and setup files
    "src/setup-polyfills.ts",
    "src/polyfills.ts",
    "*.config.ts",
    "*.config.js"
  ]

