<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Agendar Nueva Cita</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="p-4">
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <h2 class="card-title">ğŸ“… Nueva Cita MÃ©dica</h2>

        <form [formGroup]="appointmentForm" (ngSubmit)="submitAppointment()">
          <!-- Fecha -->
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">ğŸ“… Fecha de la cita</span>
            </label>
            <input
              type="date"
              formControlName="date"
              [min]="minDate"
              class="input input-bordered"
            />
          </div>

          <!-- Hora -->
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">ğŸ• Hora</span>
            </label>
            <input type="time" formControlName="time" class="input input-bordered" />
          </div>

          <!-- Doctor -->
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">ğŸ‘¨â€âš•ï¸ MÃ©dico</span>
            </label>
            <select formControlName="doctor" class="select select-bordered">
              <option value="">Selecciona un mÃ©dico</option>
              <option *ngFor="let doc of doctors" [value]="doc.name">
                {{ doc.name }} - {{ doc.specialty }}
              </option>
            </select>
          </div>

          <!-- Tipo -->
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">ğŸ“‹ Tipo de cita</span>
            </label>
            <select formControlName="type" class="select select-bordered">
              <option *ngFor="let type of appointmentTypes" [value]="type.value">
                {{ type.label }}
              </option>
            </select>
          </div>

          <!-- Notas -->
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">ğŸ“ Notas (opcional)</span>
            </label>
            <textarea
              formControlName="notes"
              class="textarea textarea-bordered"
              placeholder="Motivo de la consulta, sÃ­ntomas, etc."
            ></textarea>
          </div>

          <!-- Reminders -->
          <div class="form-control mb-4">
            <label class="label cursor-pointer">
              <span class="label-text">ğŸ”” Recordatorios</span>
              <input
                type="checkbox"
                formControlName="reminders"
                class="checkbox checkbox-primary"
              />
            </label>
          </div>

          <!-- Submit -->
          <button
            type="submit"
            class="btn btn-primary w-full"
            [class.btn-disabled]="submitting || appointmentForm.invalid"
          >
            <span *ngIf="submitting" class="loading loading-spinner"></span>
            {{ submitting ? 'Agendando...' : 'âœ… Agendar Cita' }}
          </button>
        </form>
      </div>
    </div>
  </div>
</ion-content>
