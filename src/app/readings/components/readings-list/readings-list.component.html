<!-- Loading State -->
@if (isLoading) {
  <div class="flex min-h-[300px] flex-col items-center justify-center p-8">
    <span class="loading loading-spinner loading-lg text-primary mb-4"></span>
    <p class="text-base-content/60 dark:text-base-content/80 m-0 text-sm">
      {{ 'readings.loadingReadings' | translate }}
    </p>
  </div>
}

<!-- Empty State -->
@if (!isLoading && totalCount === 0) {
  <div class="flex min-h-[400px] items-center justify-center p-8" data-testid="readings-empty">
    <app-empty-state
      illustration="description"
      [heading]="'readings.noReadings' | translate"
      [message]="'readings.noReadingsMessage' | translate"
      [ctaText]="'readings.addReading' | translate"
      (ctaClick)="onAddReading()"
    >
    </app-empty-state>
  </div>
}

<!-- No Results State (after filtering) -->
@if (!isLoading && totalCount > 0 && filteredCount === 0) {
  <div class="flex min-h-[400px] items-center justify-center p-8">
    <app-empty-state
      illustration="search"
      [heading]="'readings.noResults' | translate"
      [message]="'readings.noResultsMessage' | translate"
      [ctaText]="'readings.clearFilters' | translate"
      (ctaClick)="onClearFilters()"
    >
    </app-empty-state>
  </div>
}

<!-- Readings List (grouped by date) -->
@if (!isLoading && groupedReadings.length > 0) {
  <div class="readings-list-container" data-testid="readings-list">
    @for (group of groupedReadings; track trackByGroup($index, group)) {
      <!-- Date Header -->
      <div
        class="border-primary bg-base-100 dark:bg-base-300 sticky top-0 z-10 border-b-2 px-4 py-2"
      >
        <div class="flex items-center justify-between">
          <h2 class="text-base-content m-0 text-lg font-semibold">{{ group.displayDate }}</h2>
          <p class="text-base-content/60 dark:text-base-content/80 m-0 text-[13px]">
            {{ group.readings.length }}
            {{
              group.readings.length !== 1
                ? ('readings.readings' | translate)
                : ('readings.reading' | translate)
            }}
          </p>
        </div>
      </div>

      <!-- Readings for this date -->
      @for (reading of group.readings; track trackByReading($index, reading)) {
        <div class="px-4 py-1">
          <app-reading-item
            [reading]="reading"
            (edit)="onReadingEdit(reading)"
            class="block w-full"
          ></app-reading-item>
        </div>
      }
    }
  </div>
}
