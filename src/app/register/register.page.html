<ion-content class="login-content">
  <div class="glass-surface flex min-h-screen flex-col items-center justify-center p-5">
    <!-- Logo and Title -->
    <div class="animate-fade-in-down mb-8 text-center">
      <img
        src="assets/icon/favicon.png"
        alt="Diabetactic Logo"
        class="shadow-elevated mb-4 h-20 w-20 rounded-xl"
      />
      <h1 class="m-0 text-4xl font-bold text-white drop-shadow-lg sm:text-3xl">Crear Cuenta</h1>
      <p class="mt-2 text-sm text-white/90">Únete a Diabetactic</p>
    </div>

    <!-- Register Form -->
    <form
      [formGroup]="registerForm"
      (ngSubmit)="onSubmit()"
      class="card bg-base-100 animate-slide-in-up w-full max-w-md shadow-xl"
    >
      <div class="card-body p-8 sm:p-6">
        <!-- Name Field -->
        <ion-item lines="none" class="mb-4">
          <div class="form-control w-full">
            <label class="label">
              <span class="label-text font-medium text-gray-600 dark:text-gray-400">
                Nombre Completo
              </span>
            </label>
            <div class="relative">
              <ion-icon
                name="person-outline"
                class="absolute left-4 top-1/2 z-10 -translate-y-1/2 text-xl text-gray-400"
              ></ion-icon>
              <ion-input
                type="text"
                formControlName="name"
                placeholder="Ingresa tu nombre completo"
                [disabled]="isLoading"
                autocomplete="name"
                class="w-full rounded-xl border border-gray-200 pl-12 text-base transition-all duration-300 dark:border-gray-700"
                [class.border-danger]="isFieldInvalid('name')"
              ></ion-input>
            </div>
            <label class="label" *ngIf="nameError">
              <span class="label-text-alt text-error animate-shake flex items-center gap-1.5">
                <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
                {{ nameError }}
              </span>
            </label>
          </div>
        </ion-item>

        <!-- Email Field -->
        <ion-item lines="none" class="mb-4">
          <div class="form-control w-full">
            <label class="label">
              <span class="label-text font-medium text-gray-600 dark:text-gray-400"> Email </span>
            </label>
            <div class="relative">
              <ion-icon
                name="mail-outline"
                class="absolute left-4 top-1/2 z-10 -translate-y-1/2 text-xl text-gray-400"
              ></ion-icon>
              <ion-input
                type="email"
                formControlName="email"
                placeholder="tu@email.com"
                [disabled]="isLoading"
                autocomplete="email"
                inputmode="email"
                class="w-full rounded-xl border border-gray-200 pl-12 text-base transition-all duration-300 dark:border-gray-700"
                [class.border-danger]="isFieldInvalid('email')"
              ></ion-input>
            </div>
            <label class="label" *ngIf="emailError">
              <span class="label-text-alt text-error animate-shake flex items-center gap-1.5">
                <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
                {{ emailError }}
              </span>
            </label>
          </div>
        </ion-item>

        <!-- Password Field -->
        <ion-item lines="none" class="mb-4">
          <div class="form-control w-full">
            <label class="label">
              <span class="label-text font-medium text-gray-600 dark:text-gray-400">
                Contraseña
              </span>
            </label>
            <div class="relative">
              <ion-icon
                name="lock-closed-outline"
                class="absolute left-4 top-1/2 z-10 -translate-y-1/2 text-xl text-gray-400"
              ></ion-icon>
              <ion-input
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                placeholder="Mínimo 6 caracteres"
                [disabled]="isLoading"
                autocomplete="new-password"
                class="w-full rounded-xl border border-gray-200 pl-12 pr-12 text-base transition-all duration-300 dark:border-gray-700"
                [class.border-danger]="isFieldInvalid('password')"
              ></ion-input>
              <ion-button
                fill="clear"
                (click)="togglePasswordVisibility()"
                [disabled]="isLoading"
                class="password-toggle absolute right-0 top-1/2 m-0 h-10 -translate-y-1/2"
              >
                <ion-icon
                  slot="icon-only"
                  [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
                  class="text-xl text-gray-600"
                ></ion-icon>
              </ion-button>
            </div>
            <label class="label" *ngIf="passwordError">
              <span class="label-text-alt text-error animate-shake flex items-center gap-1.5">
                <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
                {{ passwordError }}
              </span>
            </label>
          </div>
        </ion-item>

        <!-- Confirm Password Field -->
        <ion-item lines="none" class="mb-4">
          <div class="form-control w-full">
            <label class="label">
              <span class="label-text font-medium text-gray-600 dark:text-gray-400">
                Confirmar Contraseña
              </span>
            </label>
            <div class="relative">
              <ion-icon
                name="lock-closed-outline"
                class="absolute left-4 top-1/2 z-10 -translate-y-1/2 text-xl text-gray-400"
              ></ion-icon>
              <ion-input
                [type]="showConfirmPassword ? 'text' : 'password'"
                formControlName="confirmPassword"
                placeholder="Repite tu contraseña"
                [disabled]="isLoading"
                autocomplete="new-password"
                class="w-full rounded-xl border border-gray-200 pl-12 pr-12 text-base transition-all duration-300 dark:border-gray-700"
                [class.border-danger]="isFieldInvalid('confirmPassword')"
              ></ion-input>
              <ion-button
                fill="clear"
                (click)="toggleConfirmPasswordVisibility()"
                [disabled]="isLoading"
                class="password-toggle absolute right-0 top-1/2 m-0 h-10 -translate-y-1/2"
              >
                <ion-icon
                  slot="icon-only"
                  [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"
                  class="text-xl text-gray-600"
                ></ion-icon>
              </ion-button>
            </div>
            <label class="label" *ngIf="confirmPasswordError">
              <span class="label-text-alt text-error animate-shake flex items-center gap-1.5">
                <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
                {{ confirmPasswordError }}
              </span>
            </label>
          </div>
        </ion-item>

        <!-- Age Field -->
        <ion-item lines="none" class="mb-4">
          <div class="form-control w-full">
            <label class="label">
              <span class="label-text font-medium text-gray-600 dark:text-gray-400"> Edad </span>
            </label>
            <div class="relative">
              <ion-icon
                name="calendar-outline"
                class="absolute left-4 top-1/2 z-10 -translate-y-1/2 text-xl text-gray-400"
              ></ion-icon>
              <ion-input
                type="number"
                formControlName="age"
                placeholder="Tu edad"
                [disabled]="isLoading"
                inputmode="numeric"
                class="w-full rounded-xl border border-gray-200 pl-12 text-base transition-all duration-300 dark:border-gray-700"
                [class.border-danger]="isFieldInvalid('age')"
              ></ion-input>
            </div>
            <label class="label" *ngIf="ageError">
              <span class="label-text-alt text-error animate-shake flex items-center gap-1.5">
                <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
                {{ ageError }}
              </span>
            </label>
          </div>
        </ion-item>

        <!-- Terms Checkbox -->
        <ion-item lines="none" class="checkbox-item my-5">
          <ion-checkbox
            formControlName="acceptTerms"
            [disabled]="isLoading"
            class="mr-2.5"
          ></ion-checkbox>
          <ion-label class="ml-2 text-sm text-gray-600 dark:text-gray-400">
            Acepto los <a href="#" class="text-primary hover:underline">términos y condiciones</a>
          </ion-label>
        </ion-item>

        <!-- Submit Button -->
        <ion-button
          expand="block"
          type="submit"
          [disabled]="registerForm.invalid || isLoading"
          class="btn-glow submit-button mt-5 h-12 text-base font-semibold"
        >
          <ion-spinner name="crescent" *ngIf="isLoading" class="mr-2"></ion-spinner>
          <span *ngIf="!isLoading">Registrarse</span>
        </ion-button>
      </div>
    </form>

    <!-- Login Link -->
    <div class="animate-fade-in mt-5 w-full max-w-md">
      <div class="mt-5 text-center">
        <p class="mb-1 text-sm text-white/90">¿Ya tienes cuenta?</p>
        <a
          (click)="navigateToLogin()"
          class="cursor-pointer font-semibold text-white no-underline transition-opacity hover:underline hover:opacity-80"
          >Iniciar Sesión</a
        >
      </div>
    </div>
  </div>
</ion-content>
