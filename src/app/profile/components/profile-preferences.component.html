<section class="card">
  <h3 class="text-dark m-0 text-lg font-bold">{{ 'profile.preferences' | translate }}</h3>

  <div class="preference-row">
    <div class="flex min-w-0 flex-1 items-center gap-3">
      <app-icon
        name="contrast-outline"
        aria-hidden="true"
        class="text-primary text-[26px]"
      ></app-icon>
      <div>
        <p class="text-dark m-0 text-base font-semibold">
          {{ 'profile.theme.title' | translate }}
        </p>
      </div>
    </div>
    <ion-select
      id="theme-selector"
      interface="alert"
      [value]="currentTheme"
      (ionChange)="onThemeChange($event)"
      aria-label="{{ 'profile.theme.title' | translate }}"
      data-testid="theme-selector"
    >
      <ion-select-option value="light">{{ 'profile.theme.light' | translate }}</ion-select-option>
      <ion-select-option value="dark">{{ 'profile.theme.dark' | translate }}</ion-select-option>
      <ion-select-option value="auto">{{ 'profile.theme.auto' | translate }}</ion-select-option>
    </ion-select>
  </div>

  <div class="preference-row">
    <div class="flex min-w-0 flex-1 items-center gap-3">
      <app-icon
        name="language-outline"
        aria-hidden="true"
        class="text-primary text-[26px]"
      ></app-icon>
      <div>
        <p class="text-dark m-0 text-base font-semibold">
          {{ 'profile.language.title' | translate }}
        </p>
      </div>
    </div>
    <ion-select
      id="language-selector"
      interface="alert"
      [value]="currentLanguage"
      (ionChange)="onLanguageChange($event)"
      aria-label="{{ 'profile.language.title' | translate }}"
      data-testid="language-selector"
    >
      <ion-select-option value="en">{{ 'profile.language.en' | translate }}</ion-select-option>
      <ion-select-option value="es">{{ 'profile.language.es' | translate }}</ion-select-option>
    </ion-select>
  </div>

  <div class="preference-row">
    <div class="flex min-w-0 flex-1 items-center gap-3">
      <app-icon name="water-outline" aria-hidden="true" class="text-primary text-[26px]"></app-icon>
      <div>
        <p class="text-dark m-0 text-base font-semibold">
          {{ 'profile.glucoseUnits' | translate }}
        </p>
      </div>
    </div>
    <ion-select
      interface="alert"
      [value]="currentGlucoseUnit"
      (ionChange)="onGlucoseUnitChange($event)"
      aria-label="{{ 'profile.glucoseUnits' | translate }}"
      data-testid="glucose-units-selector"
    >
      @for (option of unitOptions; track option.value) {
        <ion-select-option [value]="option.value">
          {{ option.label }}
        </ion-select-option>
      }
    </ion-select>
  </div>

  <div class="preference-row">
    <div class="flex min-w-0 flex-1 items-center gap-3">
      <app-icon
        name="notifications-outline"
        aria-hidden="true"
        class="text-primary text-[26px]"
      ></app-icon>
      <div>
        <p class="text-dark m-0 text-base font-semibold">
          {{ 'profile.notifications.title' | translate }}
        </p>
        <p class="text-medium mb-0 mt-1 text-xs">
          {{ 'profile.notifications.desc' | translate }}
        </p>
      </div>
    </div>
    <ion-toggle
      [checked]="notificationsEnabled"
      (ionChange)="onNotificationsToggle($event)"
      aria-label="{{ 'profile.notifications.title' | translate }}"
      data-testid="notifications-toggle"
    ></ion-toggle>
  </div>

  <button
    type="button"
    class="preference-row link"
    (click)="onGoToSettings()"
    data-testid="advanced-settings-btn"
  >
    <div class="flex min-w-0 flex-1 items-center gap-3">
      <app-icon
        name="settings-outline"
        aria-hidden="true"
        class="text-primary text-[26px]"
      ></app-icon>
      <div>
        <p class="text-dark m-0 text-base font-semibold">
          {{ 'profile.advancedSettings' | translate }}
        </p>
        <p class="text-medium mb-0 mt-1 text-xs">
          {{ 'profile.advancedSettingsDesc' | translate }}
        </p>
      </div>
    </div>
    <app-icon name="chevron-forward-outline" aria-hidden="true" class="text-medium"></app-icon>
  </button>
</section>
