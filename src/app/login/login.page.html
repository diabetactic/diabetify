<ion-content class="login-content">
  <div class="glass-surface flex min-h-screen flex-col items-center justify-center p-5">
    <!-- Logo and Title -->
    <div class="animate-fade-in-down mb-8 text-center">
      <img
        src="assets/icon/favicon.png"
        [alt]="'login.logoAlt' | translate"
        class="shadow-elevated mb-4 h-20 w-20 rounded-xl"
      />
      <h1 class="m-0 text-4xl font-bold text-white drop-shadow-lg sm:text-3xl">
        {{ 'login.appName' | translate }}
      </h1>
      <p class="mt-2 text-sm text-white/90">{{ 'login.tagline' | translate }}</p>
    </div>

    <!-- Demo Hint Card -->
    <ion-card *ngIf="showDemoHint" class="card-glass animate-slide-in-up mb-5 w-full max-w-md">
      <ion-card-content class="p-3">
        <div class="flex items-center gap-3">
          <app-icon
             name="information-circle-outline"
           class="shrink-0 text-2xl text-primary"></app-icon>
          <div>
            <strong>{{ 'login.demoHint.testAccount' | translate }}</strong
            ><br />
            {{ 'login.demoHint.message' | translate }}
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Login Form -->
    <form
      [formGroup]="loginForm"
      (ngSubmit)="onSubmit()"
      class="card-elevated animate-slide-in-up w-full max-w-md p-8 sm:p-6"
    >
      <!-- Username Field (DNI or Email) -->
      <ion-item
        class="form-item mb-4 rounded-xl border-2 border-gray-200 transition-all duration-300 dark:border-gray-700"
        [class.item-has-error]="isFieldInvalid('username')"
      >
        <ion-label position="floating" class="ml-10 font-medium text-gray-600 dark:text-gray-400">{{
          'login.username.label' | translate
        }}</ion-label>
        <ion-input
          type="text"
          formControlName="username"
          [placeholder]="'login.username.placeholder' | translate"
          [disabled]="isLoading"
          autocomplete="username"
          inputmode="email"
          class="text-base"
        ></ion-input>
        <app-icon
           name="person-outline"
         class="absolute left-4 z-10 text-xl text-gray-400"></app-icon>
      </ion-item>
      <div
        class="animate-shake text-danger -mt-2.5 mb-2.5 ml-1 flex items-center gap-1.5 text-xs"
        *ngIf="usernameError"
      >
        <app-icon  name="alert-circle-outline" class="text-sm"></app-icon>
        {{ usernameError }}
      </div>

      <!-- Password Field -->
      <ion-item
        class="form-item mb-4 rounded-xl border-2 border-gray-200 transition-all duration-300 dark:border-gray-700"
        [class.item-has-error]="isFieldInvalid('password')"
      >
        <ion-label position="floating" class="ml-10 font-medium text-gray-600 dark:text-gray-400">{{
          'login.password.label' | translate
        }}</ion-label>
        <ion-input
          [type]="showPassword ? 'text' : 'password'"
          formControlName="password"
          [placeholder]="'login.password.placeholder' | translate"
          [disabled]="isLoading"
          autocomplete="current-password"
          class="text-base"
        ></ion-input>
        <app-icon
           name="lock-closed-outline"
         class="absolute left-4 z-10 text-xl text-gray-400"></app-icon>
        <ion-button
          fill="clear"
          slot="end"
          (click)="togglePasswordVisibility()"
          [disabled]="isLoading"
          class="password-toggle m-0 h-10"
        >
          <ion-icon
            slot="icon-only"
            [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
            class="text-xl text-gray-600"
          ></ion-icon>
        </ion-button>
      </ion-item>
      <div
        class="animate-shake text-danger -mt-2.5 mb-2.5 ml-1 flex items-center gap-1.5 text-xs"
        *ngIf="passwordError"
      >
        <app-icon  name="alert-circle-outline" class="text-sm"></app-icon>
        {{ passwordError }}
      </div>

      <!-- Remember Me Checkbox -->
      <ion-item lines="none" class="checkbox-item my-5">
        <ion-checkbox
          formControlName="rememberMe"
          [disabled]="isLoading"
          class="mr-2.5"
        ></ion-checkbox>
        <ion-label class="ml-2 text-sm text-gray-600 dark:text-gray-400">{{
          'login.rememberMe' | translate
        }}</ion-label>
      </ion-item>

      <!-- Submit Button -->
      <ion-button
        expand="block"
        type="submit"
        [disabled]="loginForm.invalid || isLoading"
        class="btn-glow submit-button mt-5 h-12 text-base font-semibold inline-flex items-center gap-2"
      >
    <app-icon  name="loader" *ngIf="isLoading" class="mr-2 animate-spin"></app-icon>
        <span *ngIf="!isLoading">{{ 'login.submitButton' | translate }}</span>
      </ion-button>

      <!-- Forgot Password Link -->
      <div class="mt-4 text-center">
        <a
          (click)="forgotPassword()"
          class="text-primary hover:text-primary-shade cursor-pointer text-sm no-underline transition-colors hover:underline"
          >{{ 'login.forgotPassword' | translate }}</a
        >
      </div>
    </form>

    <!-- Alternative Actions -->
    <div class="animate-fade-in mt-5 w-full max-w-md">
      <div class="divider relative my-5 text-center">
        <span class="relative bg-transparent px-4 text-sm font-medium text-white">{{
          'login.divider' | translate
        }}</span>
      </div>

      <!-- Demo Mode Button -->
      <ion-button
        expand="block"
        fill="outline"
        color="primary"
        (click)="useDemoMode()"
        [disabled]="isLoading"
        class="demo-button h-12 font-semibold inline-flex items-center gap-2"
      >
    <app-icon  name="flask-outline"></app-icon>
        {{ 'login.demoButton' | translate }}
      </ion-button>

      <!-- Register Link -->
      <div class="mt-5 text-center">
        <p class="mb-1 text-sm text-white/90">{{ 'login.register.prompt' | translate }}</p>
        <a
          (click)="navigateToRegister()"
          class="cursor-pointer font-semibold text-white no-underline transition-opacity hover:underline hover:opacity-80"
          >{{ 'login.register.link' | translate }}</a
        >
      </div>
    </div>
  </div>
</ion-content>

<!-- Footer -->
<ion-footer class="login-footer">
  <ion-toolbar color="light" class="py-2.5 text-center">
    <ion-text color="medium">
      <p class="my-0.5 text-xs">{{ 'login.footer.copyright' | translate }}</p>
      <p class="my-0.5 text-xs">
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.terms' | translate
        }}</a>
        •
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.privacy' | translate
        }}</a>
        •
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.support' | translate
        }}</a>
      </p>
    </ion-text>
  </ion-toolbar>
</ion-footer>
