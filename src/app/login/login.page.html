<ion-content class="login-content">
  <div class="glass-surface flex min-h-screen flex-col items-center justify-center p-5">
    <!-- Logo and Title -->
    <div class="animate-fade-in-down mb-8 text-center">
      <img
        src="assets/icon/favicon.png"
        [alt]="'login.logoAlt' | translate"
        class="shadow-elevated mb-4 h-20 w-20 rounded-xl"
      />
      <h1 class="m-0 text-4xl font-bold text-white drop-shadow-lg sm:text-3xl">
        {{ 'login.appName' | translate }}
      </h1>
      <p class="mt-2 text-sm text-white/90">{{ 'login.tagline' | translate }}</p>
    </div>

    <!-- Demo Hint Card -->
    <div *ngIf="showDemoHint" class="card glass animate-slide-in-up mb-5 w-full max-w-md">
      <div class="card-body p-3">
        <div class="flex items-center gap-3">
          <ion-icon
            name="information-circle-outline"
            color="primary"
            class="shrink-0 text-2xl"
          ></ion-icon>
          <div>
            <strong>{{ 'login.demoHint.testAccount' | translate }}</strong
            ><br />
            {{ 'login.demoHint.message' | translate }}
          </div>
        </div>
      </div>
    </div>

    <!-- Login Form -->
    <form
      [formGroup]="loginForm"
      (ngSubmit)="onSubmit()"
      class="card bg-base-100 shadow-xl animate-slide-in-up w-full max-w-md"
    >
      <div class="card-body p-8 sm:p-6">
      <!-- Username Field (DNI or Email) -->
      <ion-item lines="none" class="mb-4">
        <div class="form-control w-full">
          <label class="label">
            <span class="label-text font-medium text-gray-600 dark:text-gray-400">
              {{ 'login.username.label' | translate }}
            </span>
          </label>
          <div class="relative">
            <ion-icon
              name="person-outline"
              class="absolute left-4 top-1/2 -translate-y-1/2 z-10 text-xl text-gray-400"
            ></ion-icon>
            <ion-input
              type="text"
              formControlName="username"
              [placeholder]="'login.username.placeholder' | translate"
              [disabled]="isLoading"
              autocomplete="username"
              inputmode="email"
              class="w-full pl-12 rounded-xl border border-gray-200 transition-all duration-300 dark:border-gray-700 text-base"
              [class.border-danger]="isFieldInvalid('username')"
            ></ion-input>
          </div>
          <label class="label" *ngIf="usernameError">
            <span class="label-text-alt text-error flex items-center gap-1.5 animate-shake">
              <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
              {{ usernameError }}
            </span>
          </label>
        </div>
      </ion-item>

      <!-- Password Field -->
      <ion-item lines="none" class="mb-4">
        <div class="form-control w-full">
          <label class="label">
            <span class="label-text font-medium text-gray-600 dark:text-gray-400">
              {{ 'login.password.label' | translate }}
            </span>
          </label>
          <div class="relative">
            <ion-icon
              name="lock-closed-outline"
              class="absolute left-4 top-1/2 -translate-y-1/2 z-10 text-xl text-gray-400"
            ></ion-icon>
            <ion-input
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              [placeholder]="'login.password.placeholder' | translate"
              [disabled]="isLoading"
              autocomplete="current-password"
              class="w-full pl-12 pr-12 rounded-xl border border-gray-200 transition-all duration-300 dark:border-gray-700 text-base"
              [class.border-danger]="isFieldInvalid('password')"
            ></ion-input>
            <ion-button
              fill="clear"
              (click)="togglePasswordVisibility()"
              [disabled]="isLoading"
              class="password-toggle absolute right-0 top-1/2 -translate-y-1/2 m-0 h-10"
            >
              <ion-icon
                slot="icon-only"
                [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
                class="text-xl text-gray-600"
              ></ion-icon>
            </ion-button>
          </div>
          <label class="label" *ngIf="passwordError">
            <span class="label-text-alt text-error flex items-center gap-1.5 animate-shake">
              <ion-icon name="alert-circle-outline" class="text-sm"></ion-icon>
              {{ passwordError }}
            </span>
          </label>
        </div>
      </ion-item>

      <!-- Remember Me Checkbox -->
      <ion-item lines="none" class="checkbox-item my-5">
        <ion-checkbox
          formControlName="rememberMe"
          [disabled]="isLoading"
          class="mr-2.5"
        ></ion-checkbox>
        <ion-label class="ml-2 text-sm text-gray-600 dark:text-gray-400">{{
          'login.rememberMe' | translate
        }}</ion-label>
      </ion-item>

      <!-- Submit Button -->
      <ion-button
        expand="block"
        type="submit"
        [disabled]="loginForm.invalid || isLoading"
        class="btn-glow submit-button mt-5 h-12 text-base font-semibold"
      >
        <ion-spinner name="crescent" *ngIf="isLoading" class="mr-2"></ion-spinner>
        <span *ngIf="!isLoading">{{ 'login.submitButton' | translate }}</span>
      </ion-button>

      <!-- Forgot Password Link -->
      <div class="mt-4 text-center">
        <a
          (click)="forgotPassword()"
          class="text-primary hover:text-primary-shade cursor-pointer text-sm no-underline transition-colors hover:underline"
          >{{ 'login.forgotPassword' | translate }}</a
        >
      </div>
      </div>
    </form>

    <!-- Alternative Actions -->
    <div class="animate-fade-in mt-5 w-full max-w-md">
      <div class="divider relative my-5 text-center">
        <span class="relative bg-transparent px-4 text-sm font-medium text-white">{{
          'login.divider' | translate
        }}</span>
      </div>

      <!-- Demo Mode Button -->
      <ion-button
        expand="block"
        fill="outline"
        color="primary"
        (click)="useDemoMode()"
        [disabled]="isLoading"
        class="demo-button h-12 font-semibold"
      >
        <ion-icon name="flask-outline" slot="start"></ion-icon>
        {{ 'login.demoButton' | translate }}
      </ion-button>

      <!-- Register Link -->
      <div class="mt-5 text-center">
        <p class="mb-1 text-sm text-white/90">{{ 'login.register.prompt' | translate }}</p>
        <a
          (click)="navigateToRegister()"
          class="cursor-pointer font-semibold text-white no-underline transition-opacity hover:underline hover:opacity-80"
          >{{ 'login.register.link' | translate }}</a
        >
      </div>
    </div>
  </div>
</ion-content>

<!-- Footer -->
<ion-footer class="login-footer">
  <ion-toolbar color="light" class="py-2.5 text-center">
    <ion-text color="medium">
      <p class="my-0.5 text-xs">{{ 'login.footer.copyright' | translate }}</p>
      <p class="my-0.5 text-xs">
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.terms' | translate
        }}</a>
        •
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.privacy' | translate
        }}</a>
        •
        <a href="#" class="text-primary mx-1.5 no-underline hover:underline">{{
          'login.footer.links.support' | translate
        }}</a>
      </p>
    </ion-text>
  </ion-toolbar>
</ion-footer>
